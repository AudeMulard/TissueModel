import sys
from datetime import date
sys.path.append('C:/Users/am2548/TissueModel/Documents/PhD/Code/TissueModel/')
from Network_generation.creation_network import Network
from Network_generation.network_types import Seeds_generation
from Plotting.information_network import *
import matplotlib.pyplot as plt
from Plotting.network_plotting import *
import random
### Network parameters

dimension=2 #dimension of the problem
creation="growth_network"
generation = 'grid'
complexity_network=30 #number of random seed points
length_domain=(1.0,1.0,1.0)
min_distance = 0.0001*length_domain[0]
beam_Young = 33000
beam_poisson = 0.3
beam_profile = 0.01
truss_young = 1.0
truss_poisson = 0.3
truss_area = 1e-9
disturbance=0.02
hyperstatic_param = 0.


### SET DATA FILE

path = '../Data/network_generation/'


network = Network(dimension, complexity_network, length_domain, min_distance, beam_Young, beam_poisson, beam_profile, truss_young, truss_poisson, truss_area,disturbance, hyperstatic_param, creation, generation, path)



from matplotlib.collections import LineCollection
fig = plt.figure()
ax1 = fig.add_subplot(221)

ax1.set_ylim([-0.1*network.length[1],network.length[1]*1.1])
ax1.set_xlim([-0.1*network.length[0],network.length[0]*1.1])
ax2 = fig.add_subplot(222, sharex=ax1, sharey=ax1)
ax3 = fig.add_subplot(223, sharex=ax1, sharey=ax1)
ax4 = fig.add_subplot(224, sharex=ax1, sharey=ax1)
Seeds = np.array(Seeds_generation(network))
#print(list(Seeds))
from numpy import array

ax1.scatter(Seeds[:,0],Seeds[:,1])
vertices = np.zeros((len(Seeds)*2,network.dimension))
lines = []
div_space = 500.

#orientations =np.random.rand(len(Seeds),1)
#print(orientations)
a_coeff,b_coeff=[],[]
for i in range(len(Seeds)):
	#a_coeff.append(180.)
	a_coeff.append(random.uniform(-1,1)*np.pi)
	b_coeff.append(float(Seeds[i][1]-a_coeff[-1]*Seeds[i][0]))
for i in range(len(Seeds)):
	lines.append([a_coeff[i],b_coeff[i], Seeds[i][0],Seeds[i][1],Seeds[i][0],Seeds[i][1],'empty','empty'])

print(a_coeff)
#print(lines)
#lines =[[1.1289887102746836, -0.018899359597804394, 0.07363180173915981, 0.06423011328289085, 0.07363180173915981, 0.06423011328289085, 'empty', 'empty'], [0.7554586766416589, 0.0743877652023163, 0.07594195276845345, 0.1317587723423555, 0.07594195276845345, 0.1317587723423555, 'empty', 'empty'], [-1.3763418557608038, 0.2726655442975754, 0.06614816367352508, 0.18162305795198647, 0.06614816367352508, 0.18162305795198647, 'empty', 'empty'], [-0.19577754995493452, 0.2658702009274681, 0.06195820511220507, 0.2537401753309953, 0.06195820511220507, 0.2537401753309953, 'empty', 'empty'], [-0.6013206966618887, 0.33781888388836345, 0.06968021850816497, 0.29591872635148103, 0.06968021850816497, 0.29591872635148103, 'empty', 'empty'], [-0.48339609654162563, 0.40341737586587223, 0.07495572890157129, 0.3671840691014204, 0.07495572890157129, 0.3671840691014204, 'empty', 'empty'], [1.0636190076425274, 0.3403802731412217, 0.06832941123268128, 0.41305673370932433, 0.06832941123268128, 0.41305673370932433, 'empty', 'empty'], [-2.5030550989002256, 0.6732339757258469, 0.07881871238733043, 0.4759463957959891, 0.07881871238733043, 0.4759463957959891, 'empty', 'empty'], [2.041923715144611, 0.4155242732505898, 0.06481962877399731, 0.547881010451085, 0.06481962877399731, 0.547881010451085, 'empty', 'empty'], [0.40551691429771763, 0.5748002840229429, 0.07122578855419671, 0.6036835460158625, 0.07122578855419671, 0.6036835460158625, 'empty', 'empty'], [-2.661571234369287, 0.8545815284163624, 0.07101643461631366, 0.6655662288741147, 0.07101643461631366, 0.6655662288741147, 'empty', 'empty'], [-0.048595414399651066, 0.7175094515702475, 0.06109229014594388, 0.7145406464139816, 0.06109229014594388, 0.7145406464139816, 'empty', 'empty'], [0.8586919029222823, 0.7159312656919736, 0.06287740224529065, 0.769923581876792, 0.06287740224529065, 0.769923581876792, 'empty', 'empty'], [1.091609099608226, 0.744495634055288, 0.07403060425857108, 0.8253081153134396, 0.07403060425857108, 0.8253081153134396, 'empty', 'empty'], [-1.8688021258993193, 1.0161106799796267, 0.06340611615567346, 0.8976171953128849, 0.06340611615567346, 0.8976171953128849, 'empty', 'empty'], [-0.05682901862665303, 0.9566136853651115, 0.0642110194420718, 0.9529646361452017, 0.0642110194420718, 0.9529646361452017, 'empty', 'empty'], [-1.1961552059519054, 0.22943063444753625, 0.13569735230278163, 0.06711554005667421, 0.13569735230278163, 0.06711554005667421, 'empty', 'empty'], [0.2851748172644877, 0.0935917027347281, 0.12705830489393305, 0.12982553161479102, 0.12705830489393305, 0.12982553161479102, 'empty', 'empty'], [-0.025096209612603462, 0.19026854648546704, 0.13682855738051983, 0.18683466832845538, 0.13682855738051983, 0.18683466832845538, 'empty', 'empty'], [1.717665290083398, 0.03473564293318032, 0.12267966301611988, 0.24545824189509738, 0.12267966301611988, 0.24545824189509738, 'empty', 'empty'], [0.18752514094924397, 0.27466650534807324, 0.11998572854051154, 0.2971668460045304, 0.11998572854051154, 0.2971668460045304, 'empty', 'empty'], [0.6694919297297256, 0.2788405747402257, 0.12985762148611, 0.3657792043390738, 0.12985762148611, 0.3657792043390738, 'empty', 'empty'], [0.30405213805654135, 0.383738897214176, 0.11870145247949444, 0.4198303276309832, 0.11870145247949444, 0.4198303276309832, 'empty', 'empty'], [-1.0068038297586817, 0.6061491883982518, 0.12930374942773518, 0.4759656782722511, 0.12930374942773518, 0.4759656782722511, 'empty', 'empty'], [-0.06275119905509459, 0.5410558064443003, 0.12863645129206105, 0.5329837148835311, 0.12863645129206105, 0.5329837148835311, 'empty', 'empty'], [-152.81354683261398, 19.617347321280423, 0.1244306891005661, 0.6026523849966364, 0.1244306891005661, 0.6026523849966364, 'empty', 'empty'], [-0.25555512329612845, 0.6822132655056596, 0.12552181391215658, 0.6501355228749848, 0.12552181391215658, 0.6501355228749848, 'empty', 'empty'], [2.087537769965211, 0.4765259792801831, 0.11769140867755876, 0.7222112400949984, 0.11769140867755876, 0.7222112400949984, 'empty', 'empty'], [1.109925765646537, 0.6205574534506856, 0.13602343158720429, 0.7715333649009827, 0.13602343158720429, 0.7715333649009827, 'empty', 'empty'], [0.11004737907479895, 0.8230337946898721, 0.1349896647951142, 0.8378890535027601, 0.1349896647951142, 0.8378890535027601, 'empty', 'empty'], [-0.9876530801481657, 1.019948997949601, 0.13312316622622733, 0.8884694927871915, 0.13312316622622733, 0.8884694927871915, 'empty', 'empty'], [1.355433074073128, 0.7914087870610333, 0.11900832566429997, 0.9527166077564914, 0.11900832566429997, 0.9527166077564914, 'empty', 'empty'], [0.44002712715057557, -0.0231904349432719, 0.1903432492068199, 0.06056575817771112, 0.1903432492068199, 0.06056575817771112, 'empty', 'empty'], [0.7582689794612304, -0.026859217078164133, 0.19163813688012957, 0.1184540373997833, 0.19163813688012957, 0.1184540373997833, 'empty', 'empty'], [0.299792782805116, 0.12785782348921737, 0.18734505019788641, 0.18402251743280587, 0.18734505019788641, 0.18402251743280587, 'empty', 'empty'], [1.3060233398457104, -0.0031535437808593303, 0.1859167467584737, 0.23965806675389165, 0.1859167467584737, 0.23965806675389165, 'empty', 'empty'], [-0.005726333433370609, 0.30932395615490654, 0.1773757630161367, 0.3083082433928776, 0.1773757630161367, 0.3083082433928776, 'empty', 'empty'], [-0.04721461995734481, 0.3773990136996604, 0.186741854977045, 0.3685820679867896, 0.186741854977045, 0.3685820679867896, 'empty', 'empty'], [-0.38211624285485113, 0.49957511620106504, 0.19227446884480456, 0.4261039185691762, 0.19227446884480456, 0.4261039185691762, 'empty', 'empty'], [-0.26591660579058507, 0.5290209983183977, 0.192313955712954, 0.477881523969048, 0.192313955712954, 0.477881523969048, 'empty', 'empty'], [0.8970074289224629, 0.378647000013147, 0.17778053471128497, 0.5381174603669774, 0.17778053471128497, 0.5381174603669774, 'empty', 'empty'], [-6.46677816145121, 1.7738022369115707, 0.1830372055199531, 0.5901412335220811, 0.1830372055199531, 0.5901412335220811, 'empty', 'empty'], [-1.4138986454135214, 0.936568213433485, 0.1909004017436672, 0.6666543939992169, 0.1909004017436672, 0.6666543939992169, 'empty', 'empty'], [28.283720311856484, -4.620991600960966, 0.1887863401582559, 0.7185884427741441, 0.1887863401582559, 0.7185884427741441, 'empty', 'empty'], [-0.7998288399074367, 0.9327975223158017, 0.1907474123230316, 0.7802322408021258, 0.1907474123230316, 0.7802322408021258, 'empty', 'empty'], [-0.44086622003298614, 0.9255769209472884, 0.19647035584467581, 0.8389597778175104, 0.19647035584467581, 0.8389597778175104, 'empty', 'empty'], [-0.025379109475050236, 0.8902752350220222, 0.18579048194058834, 0.8855600380414297, 0.18579048194058834, 0.8855600380414297, 'empty', 'empty'], [-0.060410906297938285, 0.9602691414116568, 0.18417978793964943, 0.9491426735004604, 0.18417978793964943, 0.9491426735004604, 'empty', 'empty'], [-11.669162934778265, 2.862457316889262, 0.23974156055920057, 0.06487398448593963, 0.23974156055920057, 0.06487398448593963, 'empty', 'empty'], [-12.552129236670384, 3.1022726758808257, 0.23693685914379858, 0.12821059897709866, 0.23693685914379858, 0.12821059897709866, 'empty', 'empty'], [5.518435502416572, -1.1168561021673726, 0.23553770163067625, 0.1829435126689526, 0.23553770163067625, 0.1829435126689526, 'empty', 'empty'], [1.0318451371586224, -0.01681976399760629, 0.2518907972038778, 0.24309253019222374, 0.2518907972038778, 0.24309253019222374, 'empty', 'empty'], [0.7278380552681432, 0.13592731132633074, 0.24185608762212432, 0.3119593757959793, 0.24185608762212432, 0.3119593757959793, 'empty', 'empty'], [-0.44849972329469867, 0.4603718059990286, 0.23544078629547996, 0.3547766784932196, 0.23544078629547996, 0.3547766784932196, 'empty', 'empty'], [18.511203748498463, -4.1305066156605115, 0.2464222808181888, 0.43106643273468576, 0.2464222808181888, 0.43106643273468576, 'empty', 'empty'], [-0.1435842053600526, 0.5120724719861489, 0.246903136313709, 0.4766210813576403, 0.246903136313709, 0.4766210813576403, 'empty', 'empty'], [-0.8761003682806565, 0.7671230565300289, 0.2496990607961496, 0.5483616174071881, 0.2496990607961496, 0.5483616174071881, 'empty', 'empty'], [-1.549918209431433, 0.9698717534863814, 0.23812384993098432, 0.600799262378431, 0.23812384993098432, 0.600799262378431, 'empty', 'empty'], [-3.0150376136262635, 1.359280996392903, 0.23615335425247513, 0.6472697507376827, 0.23615335425247513, 0.6472697507376827, 'empty', 'empty'], [2.478707168549709, 0.1019174343448146, 0.24369216462624996, 0.7059589497232961, 0.24369216462624996, 0.7059589497232961, 'empty', 'empty'], [-0.9798673907197976, 1.0264753710015202, 0.25281040436820607, 0.7787546997264292, 0.25281040436820607, 0.7787546997264292, 'empty', 'empty'], [0.8172036991687254, 0.6348657392909715, 0.25441412251173506, 0.8427739013283266, 0.25441412251173506, 0.8427739013283266, 'empty', 'empty'], [-2.219326979713929, 1.4401829600890919, 0.2510900639137179, 0.882932006907283, 0.2510900639137179, 0.882932006907283, 'empty', 'empty'], [1.3653248521972134, 0.6002572286715531, 0.25139884871616636, 0.9434983246375025, 0.25139884871616636, 0.9434983246375025, 'empty', 'empty'], [0.4433620066129246, -0.07279950199189458, 0.3020513637330922, 0.06111859673297954, 0.3020513637330922, 0.06111859673297954, 'empty', 'empty'], [-1.6859930258969977, 0.6479045924275897, 0.31172167264164113, 0.12234402633283582, 0.31172167264164113, 0.12234402633283582, 'empty', 'empty'], [-60.66784632432342, 18.149108342215467, 0.29602203432582247, 0.19008905512287536, 0.29602203432582247, 0.19008905512287536, 'empty', 'empty'], [20.78793797604853, -6.260793457688715, 0.31264564683188595, 0.23846485713410312, 0.31264564683188595, 0.23846485713410312, 'empty', 'empty'], [-0.6107280950909192, 0.4959354439663407, 0.30970911715698546, 0.3067873848127647, 0.30970911715698546, 0.3067873848127647, 'empty', 'empty'], [-0.3951023104361893, 0.48688691419601904, 0.29429323203189345, 0.37061097827448436, 0.29429323203189345, 0.37061097827448436, 'empty', 'empty'], [7.466981230405986, -1.8101415828621814, 0.29771801158255734, 0.41291322157856625, 0.29771801158255734, 0.41291322157856625, 'empty', 'empty'], [0.06911435527540465, 0.4687620561540239, 0.3097418245389886, 0.4901696626588636, 0.3097418245389886, 0.4901696626588636, 'empty', 'empty'], [-32.6762227678536, 10.434849403075921, 0.30280004122095355, 0.5404878020247879, 0.30280004122095355, 0.5404878020247879, 'empty', 'empty'], [-1.4630599248617204, 1.044587329956213, 0.3026100900282743, 0.6018506343770474, 0.3026100900282743, 0.6018506343770474, 'empty', 'empty'], [-0.037175909980769306, 0.6585729407680705, 0.2993226407389978, 0.6474453492207514, 0.2993226407389978, 0.6474453492207514, 'empty', 'empty'], [-0.7280580860071182, 0.9442307198829725, 0.3044195749833994, 0.7225955867774583, 0.3044195749833994, 0.7225955867774583, 'empty', 'empty'], [-0.18875442997493813, 0.8390954109526635, 0.2954012264962508, 0.7833371208314661, 0.2954012264962508, 0.7833371208314661, 'empty', 'empty'], [0.10311461144491121, 0.7962215977028151, 0.2991154855084359, 0.8270647747681734, 0.2991154855084359, 0.8270647747681734, 'empty', 'empty'], [224.0789391149728, -65.42324576282302, 0.2959683766103553, 0.8970340796061333, 0.2959683766103553, 0.8970340796061333, 'empty', 'empty'], [-0.342015691160428, 1.056125949476315, 0.29524268953787997, 0.9551483169539534, 0.29524268953787997, 0.9551483169539534, 'empty', 'empty'], [-2.9975495240372303, 1.1840872825675204, 0.3701174669739325, 0.07464184560194384, 0.3701174669739325, 0.07464184560194384, 'empty', 'empty'], [0.73850223879571, -0.14425744761817583, 0.3725769472174757, 0.13089146202560104, 0.3725769472174757, 0.13089146202560104, 'empty', 'empty'], [-1.7981796618018986, 0.8623385979699297, 0.3711751934418352, 0.1948989141574362, 0.3711751934418352, 0.1948989141574362, 'empty', 'empty'], [-0.6602106347126981, 0.47586879658927433, 0.36039166242602155, 0.2379343883938262, 0.36039166242602155, 0.2379343883938262, 'empty', 'empty'], [0.16379188560382413, 0.24496613164199255, 0.3566004658346214, 0.30337439434824726, 0.3566004658346214, 0.30337439434824726, 'empty', 'empty'], [1.4522174763039384, -0.16428050515105386, 0.36332280590241306, 0.36334322312021405, 0.36332280590241306, 0.36334322312021405, 'empty', 'empty'], [7.601008242752223, -2.4162402495299684, 0.3723927476122487, 0.4143200946118824, 0.3723927476122487, 0.4143200946118824, 'empty', 'empty'], [-0.12349073034282444, 0.5180452318736033, 0.3538909025460436, 0.4743429858565111, 0.3538909025460436, 0.4743429858565111, 'empty', 'empty'], [-2.6339290403818905, 1.475646727798043, 0.3552274803649499, 0.5400027513231138, 0.3552274803649499, 0.5400027513231138, 'empty', 'empty'], [0.2801442773659929, 0.49381210503746903, 0.3609685893779303, 0.5949353896605711, 0.3609685893779303, 0.5949353896605711, 'empty', 'empty'], [2.1852404704081034, -0.11818754683106636, 0.354472258542682, 0.6564195781733669, 0.354472258542682, 0.6564195781733669, 'empty', 'empty'], [-0.9726532228687557, 1.079596831800903, 0.3648803939609872, 0.7246947406531276, 0.3648803939609872, 0.7246947406531276, 'empty', 'empty'], [-8.629630402321704, 3.853502349585004, 0.357061534132597, 0.7721932791347159, 0.357061534132597, 0.7721932791347159, 'empty', 'empty'], [1.9301841935190873, 0.14501307472292535, 0.3564295557580185, 0.8329877693500828, 0.3564295557580185, 0.8329877693500828, 'empty', 'empty'], [13.054238756006914, -3.8573678137111047, 0.363308012743866, 0.8853417266177246, 0.363308012743866, 0.8853417266177246, 'empty', 'empty'], [1.169447368589565, 0.5316625427746762, 0.36142283129448327, 0.9543275217802, 0.36142283129448327, 0.9543275217802, 'empty', 'empty'], [0.200802025096091, -0.022275277663702096, 0.4149003143943391, 0.06103754567968602, 0.4149003143943391, 0.06103754567968602, 'empty', 'empty'], [0.958576157057193, -0.2828110645356992, 0.4295834103215017, 0.12897735006580918, 0.4295834103215017, 0.12897735006580918, 'empty', 'empty'], [6.644241814884884, -2.661185020953695, 0.42981248096209995, 0.19459303761410293, 0.42981248096209995, 0.19459303761410293, 'empty', 'empty'], [-0.03794745053712037, 0.26242859496942333, 0.41237615879749695, 0.2467799710807676, 0.41237615879749695, 0.2467799710807676, 'empty', 'empty'], [-6.795811295653791, 3.1933314654251794, 0.4252765509789031, 0.3032322765060648, 0.4252765509789031, 0.3032322765060648, 'empty', 'empty'], [-0.5513405355341552, 0.599628045754957, 0.43031307051719, 0.3623790070086627, 0.43031307051719, 0.3623790070086627, 'empty', 'empty'], [-2.623043222356859, 1.5219020501266638, 0.4220885884465007, 0.41474543896789645, 0.4220885884465007, 0.41474543896789645, 'empty', 'empty'], [-2.100005204050648, 1.3844297986015697, 0.4314899034415423, 0.4782987558790193, 0.4314899034415423, 0.4782987558790193, 'empty', 'empty'], [0.2559442398869348, 0.4338355285471682, 0.4139381821352579, 0.5397806219339564, 0.4139381821352579, 0.5397806219339564, 'empty', 'empty'], [-1.1131511823533287, 1.0685341606365033, 0.4227944174193993, 0.5979000549937121, 0.4227944174193993, 0.5979000549937121, 'empty', 'empty'], [0.5025623224611886, 0.4522865299595392, 0.416142971667157, 0.6614243082764862, 0.416142971667157, 0.6614243082764862, 'empty', 'empty'], [15.823433392789962, -5.865013466372063, 0.41618733249165024, 0.7204990682324949, 0.41618733249165024, 0.7204990682324949, 'empty', 'empty'], [-0.10276536077762309, 0.8096481132764846, 0.42093183161164555, 0.7663909017381281, 0.42093183161164555, 0.7663909017381281, 'empty', 'empty'], [-1.7370017822033328, 1.559578056652171, 0.4188476166263485, 0.8320390001005855, 0.4188476166263485, 0.8320390001005855, 'empty', 'empty'], [0.28852629519988837, 0.7661187928749144, 0.42177894037676805, 0.8878131079351579, 0.42177894037676805, 0.8878131079351579, 'empty', 'empty'], [-20.4993174376422, 9.746063238426176, 0.42945992255747106, 0.9424279591753397, 0.42945992255747106, 0.9424279591753397, 'empty', 'empty'], [1.0586844287798847, -0.4341480984098983, 0.4769117721477831, 0.07075096866477995, 0.4769117721477831, 0.07075096866477995, 'empty', 'empty'], [2.71917599425748, -1.157319388386344, 0.4730993186080858, 0.12912092167233383, 0.4730993186080858, 0.12912092167233383, 'empty', 'empty'], [2.444349576655325, -0.9945256470708611, 0.48506181177922986, 0.19113498720336441, 0.48506181177922986, 0.19113498720336441, 'empty', 'empty'], [0.15810185761836226, 0.16610132050403395, 0.48796008997141005, 0.24324871717213706, 0.48796008997141005, 0.24324871717213706, 'empty', 'empty'], [0.00484745364899361, 0.30611641347653534, 0.4835265859376006, 0.308460286189924, 0.4835265859376006, 0.308460286189924, 'empty', 'empty'], [0.5955827747848647, 0.07217739314689431, 0.47363022517531467, 0.3542633968787885, 0.47363022517531467, 0.3542633968787885, 'empty', 'empty'], [-0.05196078663211064, 0.4469934215024251, 0.4772059779193587, 0.4221974235041896, 0.4772059779193587, 0.4221974235041896, 'empty', 'empty'], [-6.430149939077712, 3.568117989702537, 0.4801015969872843, 0.4809927350836389, 0.4801015969872843, 0.4809927350836389, 'empty', 'empty'], [-2.6408027921086004, 1.8269898421787247, 0.4852034510661865, 0.5456632138624106, 0.4852034510661865, 0.5456632138624106, 'empty', 'empty'], [-0.6041506423474984, 0.8966010940589059, 0.4774160611122619, 0.6081698740709203, 0.4774160611122619, 0.6081698740709203, 'empty', 'empty'], [-0.8264519438957881, 1.0626310938410655, 0.48302302849159445, 0.6634357729977566, 0.48302302849159445, 0.6634357729977566, 'empty', 'empty'], [-1.1381719827854475, 1.263170463548417, 0.4877603473428163, 0.7080153018891252, 0.4877603473428163, 0.7080153018891252, 'empty', 'empty'], [-0.43799884262077404, 0.9814380880474716, 0.48883135266909195, 0.7673305213416619, 0.48883135266909195, 0.7673305213416619, 'empty', 'empty'], [2.287316277874928, -0.2549898226488432, 0.47506284094551293, 0.8316291464593364, 0.47506284094551293, 0.8316291464593364, 'empty', 'empty'], [-2.3059202644109016, 1.9903634548766325, 0.4724545617716059, 0.9009209068741144, 0.4724545617716059, 0.9009209068741144, 'empty', 'empty'], [0.14374812256715194, 0.8749255829309537, 0.47776389829317045, 0.9436032463409607, 0.47776389829317045, 0.9436032463409607, 'empty', 'empty'], [-0.510017600174307, 0.34051080180079457, 0.540796433562513, 0.06469510257241766, 0.540796433562513, 0.06469510257241766, 'empty', 'empty'], [0.3952079819393277, -0.0782223561144692, 0.544440920845207, 0.1369450414979543, 0.544440920845207, 0.1369450414979543, 'empty', 'empty'], [0.432727418219381, -0.05381917600994032, 0.5355206544487945, 0.17791529419283977, 0.5355206544487945, 0.17791529419283977, 'empty', 'empty'], [-0.75360638228285, 0.6419181542169627, 0.5383703950094578, 0.23619878850569634, 0.5383703950094578, 0.23619878850569634, 'empty', 'empty'], [2.0146866895425015, -0.7767081216699827, 0.5402483969779202, 0.3117231327681064, 0.5402483969779202, 0.3117231327681064, 'empty', 'empty'], [0.2767604372942976, 0.2129223582358014, 0.5300601574319296, 0.3596220391989465, 0.5300601574319296, 0.3596220391989465, 'empty', 'empty'], [-0.15177435194041541, 0.5142454176078127, 0.5481093649191893, 0.4310564739547301, 0.5481093649191893, 0.4310564739547301, 'empty', 'empty'], [-0.38275994644196365, 0.6783094820581597, 0.5331701421332405, 0.47423330701078636, 0.5331701421332405, 0.47423330701078636, 'empty', 'empty'], [-0.5955283989089606, 0.8678084457219228, 0.5439169569827523, 0.5438904511905504, 0.5439169569827523, 0.5438904511905504, 'empty', 'empty'], [-0.3203609447544081, 0.7629191941647608, 0.5429867303044338, 0.5889674522553254, 0.5429867303044338, 0.5889674522553254, 'empty', 'empty'], [-0.011639227659134159, 0.6703106497098356, 0.5450176343217856, 0.6639670653857216, 0.5450176343217856, 0.6639670653857216, 'empty', 'empty'], [0.10916249048643266, 0.6493883159098954, 0.5369227989119042, 0.7080001458380649, 0.5369227989119042, 0.7080001458380649, 'empty', 'empty'], [0.32136138964558747, 0.6078773371585868, 0.5389139062033521, 0.7810634589554278, 0.5389139062033521, 0.7810634589554278, 'empty', 'empty'], [0.16915843921344992, 0.7362878447167934, 0.5449858833877012, 0.8284768061440202, 0.5449858833877012, 0.8284768061440202, 'empty', 'empty'], [0.41284945858609706, 0.669033532404904, 0.5429751687894279, 0.893200536865314, 0.5429751687894279, 0.893200536865314, 'empty', 'empty'], [-0.8814294095931535, 1.4166438918186812, 0.5351661056364007, 0.9449327472933213, 0.5351661056364007, 0.9449327472933213, 'empty', 'empty'], [-0.04423201454091971, 0.10129604790170825, 0.6069645395515665, 0.07444878356244072, 0.6069645395515665, 0.07444878356244072, 'empty', 'empty'], [2.8104602833236094, -1.5339586474538291, 0.5911721679750415, 0.12750725124633824, 0.5911721679750415, 0.12750725124633824, 'empty', 'empty'], [2.1657953205788916, -1.1329976911855977, 0.606983945192134, 0.1816052969780404, 0.606983945192134, 0.1816052969780404, 'empty', 'empty'], [0.5853167307893973, -0.0983439353215732, 0.597447930630655, 0.2513523342520524, 0.597447930630655, 0.2513523342520524, 'empty', 'empty'], [-0.13502087096308654, 0.3899431600641311, 0.5962980013271919, 0.30943048457138594, 0.5962980013271919, 0.30943048457138594, 'empty', 'empty'], [1.289381860200065, -0.41611183967020005, 0.604811731899359, 0.3637214362770185, 0.604811731899359, 0.3637214362770185, 'empty', 'empty'], [-2.0358184382353084, 1.6449026804781934, 0.6053254680974309, 0.41256993139202447, 0.6053254680974309, 0.41256993139202447, 'empty', 'empty'], [-0.912006600386154, 1.015473940851145, 0.5901720804077735, 0.47723310815562764, 0.5901720804077735, 0.47723310815562764, 'empty', 'empty'], [0.34105938809377906, 0.34276892167335665, 0.6010682640658632, 0.54776889601825, 0.6010682640658632, 0.54776889601825, 'empty', 'empty'], [0.6269510562898127, 0.22869668514617725, 0.5936448266075319, 0.6008829362487521, 0.5936448266075319, 0.6008829362487521, 'empty', 'empty'], [-2.5539046839690083, 2.1939899482550604, 0.598219915033498, 0.666193305207468, 0.598219915033498, 0.666193305207468, 'empty', 'empty'], [-0.7709805011187226, 1.177681665681002, 0.600513756625176, 0.7146972686694372, 0.600513756625176, 0.7146972686694372, 'empty', 'empty'], [-2.8954400600001775, 2.484051945545867, 0.590520697710954, 0.7742346611343158, 0.590520697710954, 0.7742346611343158, 'empty', 'empty'], [0.894866032922323, 0.2925686543017112, 0.5962502836092513, 0.8261327802239319, 0.5962502836092513, 0.8261327802239319, 'empty', 'empty'], [-0.5042000178181792, 1.2021095600262808, 0.5954289385555658, 0.9018942785971049, 0.5954289385555658, 0.9018942785971049, 'empty', 'empty'], [-0.9217295661339979, 1.5082726275373006, 0.5949915600890024, 0.9598513150030739, 0.5949915600890024, 0.9598513150030739, 'empty', 'empty'], [-2.75441735463486, 1.8475722532405405, 0.6474387248854833, 0.06425579335330095, 0.6474387248854833, 0.06425579335330095, 'empty', 'empty'], [-0.2494052354592096, 0.29190715549374646, 0.6574256833024068, 0.12794174815277792, 0.6574256833024068, 0.12794174815277792, 'empty', 'empty'], [0.9363534780035425, -0.4342026802397613, 0.6634749082073764, 0.18704435762829671, 0.6634749082073764, 0.18704435762829671, 'empty', 'empty'], [-6.943085503770047, 4.812051565017354, 0.6572198206420977, 0.24891815552685503, 0.6572198206420977, 0.24891815552685503, 'empty', 'empty'], [1.9248515696645137, -0.9590714710904731, 0.6612285250544468, 0.31369529326753004, 0.6612285250544468, 0.31369529326753004, 'empty', 'empty'], [-0.23604162257599448, 0.5180725801817151, 0.6605583189719737, 0.3621533227654991, 0.6605583189719737, 0.3621533227654991, 'empty', 'empty'], [0.02239408589781185, 0.40206947823710804, 0.6578453016776031, 0.41680132243034823, 0.6578453016776031, 0.41680132243034823, 'empty', 'empty'], [-1.1048492580698523, 1.1921445370328716, 0.6529002604997995, 0.4707881686260548, 0.6529002604997995, 0.4707881686260548, 'empty', 'empty'], [-0.8452462244723157, 1.0882698795747987, 0.6536922053607296, 0.5357390110266605, 0.6536922053607296, 0.5357390110266605, 'empty', 'empty'], [0.061964839114710596, 0.5632950149741919, 0.6492611779351694, 0.6035263794083722, 0.6492611779351694, 0.6035263794083722, 'empty', 'empty'], [-0.2931394097847335, 0.858054930515237, 0.667003555257291, 0.6625299020027958, 0.667003555257291, 0.6625299020027958, 'empty', 'empty'], [1.7262593871155085, -0.4073372631005985, 0.6515337510561788, 0.717378990682709, 0.6515337510561788, 0.717378990682709, 'empty', 'empty'], [0.06529779856311428, 0.7359981658599668, 0.6558943315350233, 0.7788266217992292, 0.6558943315350233, 0.7788266217992292, 'empty', 'empty'], [-0.594316909589268, 1.2212350576004622, 0.6606673694596665, 0.8285892683167221, 0.6606673694596665, 0.8285892683167221, 'empty', 'empty'], [-7.403145388391059, 5.795562060764112, 0.6613938347466446, 0.8991673431492121, 0.6613938347466446, 0.8991673431492121, 'empty', 'empty'], [-3.704621343082726, 3.3628606827797585, 0.6493208433595272, 0.9573728279615782, 0.6493208433595272, 0.9573728279615782, 'empty', 'empty'], [-0.9110868642100125, 0.7201627365747787, 0.7104061227776285, 0.07292104985771602, 0.7104061227776285, 0.07292104985771602, 'empty', 'empty'], [1.1000721562193798, -0.6693748902417103, 0.7179102417938101, 0.12037817742038276, 0.7179102417938101, 0.12037817742038276, 'empty', 'empty'], [-4.276061660086883, 3.262998884206233, 0.7172881455396581, 0.19583054582928094, 0.7172881455396581, 0.19583054582928094, 'empty', 'empty'], [-1.1470371595957243, 1.0805905435016694, 0.7253368906358978, 0.24860217671667478, 0.7253368906358978, 0.24860217671667478, 'empty', 'empty'], [3.2401709691784704, -2.0211944589783117, 0.7188582880545651, 0.30802929692942455, 0.7188582880545651, 0.30802929692942455, 'empty', 'empty'], [-10.892301370750813, 8.17807048072942, 0.7172149567684575, 0.36594902399736573, 0.7172149567684575, 0.36594902399736573, 'empty', 'empty'], [0.6167737225761002, -0.013051061147624388, 0.7067842779302027, 0.42287490900964775, 0.7067842779302027, 0.42287490900964775, 'empty', 'empty'], [20.75476811953514, -14.328258353397809, 0.7138566459436043, 0.4876708037507942, 0.7138566459436043, 0.4876708037507942, 'empty', 'empty'], [1.0229105613508402, -0.19626565521234618, 0.7127836155109645, 0.532848233051656, 0.7127836155109645, 0.532848233051656, 'empty', 'empty'], [0.058164649413441086, 0.5498910692029322, 0.7082712602513991, 0.5910874187450709, 0.7082712602513991, 0.5910874187450709, 'empty', 'empty'], [-1.1617410589803148, 1.4881839603728455, 0.7115788188964316, 0.6615136297601434, 0.7115788188964316, 0.6615136297601434, 'empty', 'empty'], [1.9324409901612385, -0.6662953553330221, 0.7138833626411608, 0.7132421168288973, 0.7138833626411608, 0.7132421168288973, 'empty', 'empty'], [-8.030796011768684, 6.478548423130956, 0.7092815098204237, 0.7824533028438271, 0.7092815098204237, 0.7824533028438271, 'empty', 'empty'], [0.5983877460612911, 0.4068240724291457, 0.7136682992021038, 0.8338744374240877, 0.7136682992021038, 0.8338744374240877, 'empty', 'empty'], [-4.704522091576599, 4.287028587265897, 0.7226907103314759, 0.8871141751342843, 0.7226907103314759, 0.8871141751342843, 'empty', 'empty'], [0.8324249852241858, 0.3568302115606886, 0.710386299702665, 0.9481735165941436, 0.710386299702665, 0.9481735165941436, 'empty', 'empty'], [1.3567731379432295, -0.9700753338257739, 0.7709602227214084, 0.07594278678536243, 0.7709602227214084, 0.07594278678536243, 'empty', 'empty'], [1.6514921511199432, -1.1520789847039474, 0.7778047271336591, 0.13245941726127958, 0.7778047271336591, 0.13245941726127958, 'empty', 'empty'], [0.3572454419697614, -0.09222990635341546, 0.7832477966106476, 0.18758179891859708, 0.7832477966106476, 0.18758179891859708, 'empty', 'empty'], [-0.2109900194015059, 0.3995663263610204, 0.7690427294169749, 0.23730598596074579, 0.7690427294169749, 0.23730598596074579, 'empty', 'empty'], [-2.646017596187139, 2.3404507073708825, 0.772800577643187, 0.2956067805834242, 0.772800577643187, 0.2956067805834242, 'empty', 'empty'], [-0.7175887697049873, 0.9185614748700608, 0.7764865410415868, 0.3613634531915474, 0.7764865410415868, 0.3613634531915474, 'empty', 'empty'], [0.7413347032018407, -0.16357581794257414, 0.7827765896526042, 0.4167236328208882, 0.7827765896526042, 0.4167236328208882, 'empty', 'empty'], [-0.571537841254932, 0.9198548952126537, 0.780477273264516, 0.4737825993025166, 0.780477273264516, 0.4737825993025166, 'empty', 'empty'], [-2.744867832661494, 2.631732843012379, 0.7652733929527902, 0.531158523504546, 0.7652733929527902, 0.531158523504546, 'empty', 'empty'], [1.0324132413408946, -0.21075216647171746, 0.7794637703553343, 0.593976551188628, 0.7794637703553343, 0.593976551188628, 'empty', 'empty'], [-0.9587414115337964, 1.4047181418173755, 0.7826551980542277, 0.6543541924906021, 0.7826551980542277, 0.6543541924906021, 'empty', 'empty'], [-0.3526370260746226, 0.9884169865223993, 0.773180284492592, 0.715764990379401, 0.773180284492592, 0.715764990379401, 'empty', 'empty'], [2.342968817079009, -1.0568854714038993, 0.7796709375024746, 0.7698592227471556, 0.7796709375024746, 0.7698592227471556, 'empty', 'empty'], [0.757129451960003, 0.2449233188918264, 0.7733537173492714, 0.8304521950797114, 0.7733537173492714, 0.8304521950797114, 'empty', 'empty'], [0.8011656952604941, 0.2813164402264313, 0.7750387144789554, 0.9022508707657633, 0.7750387144789554, 0.9022508707657633, 'empty', 'empty'], [-1.9527636021087447, 2.4698366168070987, 0.7806705071299812, 0.9453716652438959, 0.7806705071299812, 0.9453716652438959, 'empty', 'empty'], [-8.970232489284017, 7.509039698883885, 0.8292888681567885, 0.07012575074229055, 0.8292888681567885, 0.07012575074229055, 'empty', 'empty'], [0.05825781805263456, 0.08165945339980826, 0.8339046239149254, 0.13024091725309464, 0.8339046239149254, 0.13024091725309464, 'empty', 'empty'], [2.038670782111982, -1.4966552193705394, 0.8251823736301116, 0.18561997566298194, 0.8251823736301116, 0.18561997566298194, 'empty', 'empty'], [-3.9516892890698108, 3.521337879447434, 0.8276651784503317, 0.2506622588292043, 0.8276651784503317, 0.2506622588292043, 'empty', 'empty'], [-0.27730677144370325, 0.543613220818746, 0.8371913918948226, 0.3114543788519326, 0.8371913918948226, 0.3114543788519326, 'empty', 'empty'], [0.44248137561583967, -0.007730650647358894, 0.840515554163481, 0.364181827985408, 0.840515554163481, 0.364181827985408, 'empty', 'empty'], [5.671811353541801, -4.335636424215436, 0.8383497639502403, 0.41932528519662615, 0.8383497639502403, 0.41932528519662615, 'empty', 'empty'], [-0.8003420983244209, 1.138634226567261, 0.8322054945864072, 0.47258513479286346, 0.8322054945864072, 0.47258513479286346, 'empty', 'empty'], [1.046098457607784, -0.31724289107542714, 0.8240694015668251, 0.5448148388653982, 0.8240694015668251, 0.5448148388653982, 'empty', 'empty'], [-0.9947765190176524, 1.4360408985096167, 0.8363310952339696, 0.6040783628465476, 0.8363310952339696, 0.6040783628465476, 'empty', 'empty'], [-0.5789354319509338, 1.1377743951704842, 0.8359653516319175, 0.6538044332274459, 0.8359653516319175, 0.6538044332274459, 'empty', 'empty'], [-1.704692956840317, 2.1152205491265326, 0.825284354080525, 0.7083641233349509, 0.825284354080525, 0.7083641233349509, 'empty', 'empty'], [3.460790807468399, -2.08088701743473, 0.8278682142369275, 0.784191688191708, 0.8278682142369275, 0.784191688191708, 'empty', 'empty'], [-1.3734210792299733, 1.975077867996402, 0.837739396980641, 0.8245089212817831, 0.837739396980641, 0.8245089212817831, 'empty', 'empty'], [12.997410093725593, -9.943375445907666, 0.8342605318998769, 0.8998508122046764, 0.8342605318998769, 0.8998508122046764, 'empty', 'empty'], [0.6691128989843744, 0.39050650044569934, 0.8391212200882928, 0.9519733326182822, 0.8391212200882928, 0.9519733326182822, 'empty', 'empty'], [-2.281989626832385, 2.1024587799531886, 0.8934673270925827, 0.06357560761425751, 0.8934673270925827, 0.06357560761425751, 'empty', 'empty'], [-1.9249585206571627, 1.8302891904483545, 0.8832872241507176, 0.12999792213181752, 0.8832872241507176, 0.12999792213181752, 'empty', 'empty'], [-0.9783610258262702, 1.0646934275663646, 0.8953987570851695, 0.1886701810609509, 0.8953987570851695, 0.1886701810609509, 'empty', 'empty'], [-0.6424000927139847, 0.8199014326064596, 0.8923336173492046, 0.24666623408952526, 0.8923336173492046, 0.24666623408952526, 'empty', 'empty'], [0.2722211851714377, 0.06240955161843359, 0.89062989685437, 0.3048578776892455, 0.89062989685437, 0.3048578776892455, 'empty', 'empty'], [-0.9278335630248448, 1.1904254411944277, 0.9000660703076356, 0.35531393222312363, 0.9000660703076356, 0.35531393222312363, 'empty', 'empty'], [-1.4779611661828933, 1.7553836807426362, 0.8982582865415054, 0.42779281603230523, 0.8982582865415054, 0.42779281603230523, 'empty', 'empty'], [0.5219733874375271, 0.005036381684650593, 0.8962123904996044, 0.47283539901721294, 0.8962123904996044, 0.47283539901721294, 'empty', 'empty'], [1.1674463964900372, -0.4939874830136074, 0.8876890762376124, 0.5423419302435631, 0.8876890762376124, 0.5423419302435631, 'empty', 'empty'], [-0.1979227983135611, 0.773706410942745, 0.8902880358606503, 0.597498111580121, 0.8902880358606503, 0.597498111580121, 'empty', 'empty'], [4.057900581170499, -2.9619085191924968, 0.8928020206345386, 0.6609933192105933, 0.8928020206345386, 0.6609933192105933, 'empty', 'empty'], [4.712527484661582, -3.467182077271641, 0.8894026955091633, 0.7241525702473873, 0.8894026955091633, 0.7241525702473873, 'empty', 'empty'], [-7.465743247338332, 7.375309930137116, 0.8854039320937481, 0.7651115029414094, 0.8854039320937481, 0.7651115029414094, 'empty', 'empty'], [0.9576664040554096, -0.01795060534541737, 0.8835619812149887, 0.8282070199648143, 0.8835619812149887, 0.8282070199648143, 'empty', 'empty'], [3.4767742987204473, -2.2408320943563904, 0.8995439342386563, 0.8866791367744462, 0.8995439342386563, 0.8866791367744462, 'empty', 'empty'], [45.33617116332288, -39.494794554072996, 0.8921911195587258, 0.9537347526380618, 0.8921911195587258, 0.9537347526380618, 'empty', 'empty'], [1.408823890685885, -1.263548106403025, 0.9500579184535565, 0.07491618664964762, 0.9500579184535565, 0.07491618664964762, 'empty', 'empty'], [-1.4813409049353554, 1.545776602114434, 0.9531143609309872, 0.1338893121860423, 0.9531143609309872, 0.1338893121860423, 'empty', 'empty'], [0.08457225523255536, 0.10128075873611168, 0.9419110815960418, 0.1809403031352244, 0.9419110815960418, 0.1809403031352244, 'empty', 'empty'], [4.1959551230393215, -3.7321897265493846, 0.9464510254913618, 0.23907630256691448, 0.9464510254913618, 0.23907630256691448, 'empty', 'empty'], [0.09437478648015854, 0.21405372511795606, 0.9458749869650577, 0.3033204750497061, 0.9458749869650577, 0.3033204750497061, 'empty', 'empty'], [-0.7112934026498969, 1.0479523183699726, 0.953821003482347, 0.3695057312840747, 0.953821003482347, 0.3695057312840747, 'empty', 'empty'], [-0.3549736301965788, 0.763315007644311, 0.942845904563121, 0.4286295741855629, 0.942845904563121, 0.4286295741855629, 'empty', 'empty'], [2.512031775037276, -1.9221676241344448, 0.957647870673343, 0.48347425629378077, 0.957647870673343, 0.48347425629378077, 'empty', 'empty'], [4.207295444820086, -3.4228067933140744, 0.9415494325878052, 0.5385698454855349, 0.9415494325878052, 0.5385698454855349, 'empty', 'empty'], [1.2279149123633661, -0.5818840645491367, 0.9600961871114582, 0.5970323609082314, 0.9600961871114582, 0.5970323609082314, 'empty', 'empty'], [0.3675007094843912, 0.3040053593887879, 0.9599952633456653, 0.6568042997699749, 0.9599952633456653, 0.6568042997699749, 'empty', 'empty'], [0.6423303170730382, 0.11128849639725624, 0.9425749550016681, 0.7167329661085825, 0.9425749550016681, 0.7167329661085825, 'empty', 'empty'], [0.7574558893849281, 0.06129237579163116, 0.9490075534803176, 0.7801237362460799, 0.9490075534803176, 0.7801237362460799, 'empty', 'empty'], [0.5583179204592629, 0.3043297265501669, 0.9488887538757012, 0.8341113223612296, 0.9488887538757012, 0.8341113223612296, 'empty', 'empty'], [1.2455940700111474, -0.30132901239731136, 0.9552191621747356, 0.8884863115685557, 0.9552191621747356, 0.8884863115685557, 'empty', 'empty'], [-0.41522348831880734, 1.3507528140884353, 0.9494507355626962, 0.956518567681235, 0.9494507355626962, 0.956518567681235, 'empty', 'empty']]
lines_done_up = []
lines_done_down = []



for k in range(int(div_space)):
	for i in range(len(Seeds)):
		if i not in lines_done_up:
			xk_up = Seeds[i][0]+k/div_space
			yk_up = lines[i][0]*xk_up+lines[i][1]
			if xk_up >= 1.0:
				vertices[i][0] = 1.0
				vertices[i][1] = lines[i][0]*1.0+lines[i][1]
				lines[i][4] = vertices[i][0]
				lines[i][5] = vertices[i][1]
				lines_done_up.append(i)
			else:
				lines[i][4]=xk_up+1./div_space
				lines[i][5]=lines[i][0]*(xk_up+1./div_space)+lines[i][1]
				for j in range(len(Seeds)):
					if i !=j and i not in lines_done_up:
						if lines[j][2]<= xk_up <xk_up+1./div_space<=lines[j][4]:
							x_inter = (lines[j][1]-lines[i][1])/(lines[i][0]-lines[j][0])
							if xk_up<=x_inter<=xk_up+1./div_space:
								vertices[i][0] = x_inter
								vertices[i][1] = lines[j][0]*x_inter+lines[j][1]
								lines[i][6] = j
								lines_done_up.append(i)
								lines[i][4] = vertices[i][0]
								lines[i][5] = vertices[i][1]
		if i not in lines_done_down:
			xk_dw = Seeds[i][0]-k/div_space
			yk_dw = lines[i][0]*xk_dw+lines[i][1]
			if xk_dw <=0.0:
				vertices[len(Seeds)+i][0] = 0.0
				vertices[len(Seeds)+i][1] = lines[i][1] 
				lines_done_down.append(i)
				lines[i][2] = vertices[len(Seeds)+i][0]
				lines[i][3] = vertices[len(Seeds)+i][1]
			else:
				lines[i][2]=xk_dw-1./div_space
				lines[i][3]=lines[i][0]*(xk_dw-1./div_space)+lines[i][1]
				for j in range(len(Seeds)):
					if i !=j and i not in lines_done_down:
						if lines[j][2]<= xk_dw-1./div_space<= xk_dw<= lines[j][4]:
							x_inter = (lines[j][1]-lines[i][1])/(lines[i][0]-lines[j][0])
							if xk_dw-1./div_space<=x_inter<=xk_dw:
								vertices[len(Seeds)+i][0] = x_inter
								vertices[len(Seeds)+i][1] = lines[j][1] + x_inter*lines[j][0]
								lines[i][7]=j
								lines_done_down.append(i)
								lines[i][2] = vertices[len(Seeds)+i][0]
								lines[i][3] = vertices[len(Seeds)+i][1]
		if k==5: ax2.plot([lines[i][4],lines[i][2]],[lines[i][5],lines[i][3]],color='C0')
		if k==50: ax3.plot([lines[i][4],lines[i][2]],[lines[i][5],lines[i][3]],color='C0')
		if k==499: ax4.plot([lines[i][4],lines[i][2]],[lines[i][5],lines[i][3]],color='C0')
	
ax1.set_title('Initial points')
ax2.set_title('Step 5')
ax3.set_title('Step 500')
ax4.set_title('Generation finished')
ax1.tick_params(labelsize=8)
ax2.tick_params(labelsize=8)
ax3.tick_params(labelsize=8)
ax4.tick_params(labelsize=8)
ridge_vertices = []
list_points = []
import operator
for i in range(len(lines)):
	list_point =[[i, vertices[i][0]], [len(Seeds) + i, vertices[len(Seeds) + i][0]]]
	for j in range(len(lines)):
		if lines[j][6] == i:
			list_point.append([j, vertices[j][0]])
		if lines[j][7] == i:
			list_point.append([len(Seeds)+j, vertices[len(Seeds)+j][0]])
	list_point = sorted(list_point,key=operator.itemgetter(1))
	list_points.append(list_point)
for list_point in list_points:
	for i in range(len(list_point)-1):
		ridge_vertices.append([list_point[i][0],list_point[i+1][0]])

network.vertices=vertices
network.ridge_vertices=ridge_vertices
plt.subplots_adjust(hspace=0.5)
os.chdir(path)
#plt.savefig('generation_growth.pdf')
plt.show()
"""
############################################################

def set_fibers_explanation(network, path):
	from scipy.spatial import Voronoi, voronoi_plot_2d
	import matplotlib.pyplot as plt
	from matplotlib.collections import LineCollection
	fig = plt.figure()
	ax1 = fig.add_subplot(221)
	ax2 = fig.add_subplot(222, sharex=ax1, sharey=ax1)
	ax3 = fig.add_subplot(223, sharex=ax1, sharey=ax1)
	ax4 = fig.add_subplot(224, sharex=ax1, sharey=ax1)
	Seeds=np.random.rand(self.complexity,self.dimension)*self.length[0]
	ax1.scatter(Seeds[:,0],Seeds[:,1])
	ax1.set_ylim([-0.1*self.length[1],self.length[1]*1.1])
	ax1.set_xlim([-0.1*self.length[0],self.length[0]*1.1])
	ax1.set_title('Initial points')
	####
	voronoi = Voronoi(Seeds)
	self.vertices = Voronoi(Seeds).vertices
	self.ridge_vertices = Voronoi(Seeds).ridge_vertices
	self = self.delete_first_point()
	ax2.scatter(self.vertices[:,0],self.vertices[:,1], s =2.)
	line_segments = []
	for simplex in self.ridge_vertices:
			simplex = np.asarray(simplex)
			line_segments.append([(x, y) for x, y in self.vertices[simplex]])
	lc = LineCollection(line_segments,linestyle='solid')
	ax2.set_title('Voronoi tesselation')
	ax2.add_collection(lc)
	####
	self = self.cut_network()
	ax3.scatter(self.vertices[:,0],self.vertices[:,1], s =2.)
	line_segments = []
	for simplex in self.ridge_vertices:
			simplex = np.asarray(simplex)
			line_segments.append([(x, y) for x, y in self.vertices[simplex]])
	lc = LineCollection(line_segments,linestyle='solid')
	ax3.set_title('Network cut')
	ax3.add_collection(lc)
	####
	self.min_distance = 0.035
	self = self.merge_nodes()
	ax4.scatter(self.vertices[:,0],self.vertices[:,1], s =2.)
	line_segments = []
	for simplex in self.ridge_vertices:
			simplex = np.asarray(simplex)
			line_segments.append([(x, y) for x, y in self.vertices[simplex]])
	lc = LineCollection(line_segments,linestyle='solid')
	ax4.set_title('Close points merged')
	ax4.add_collection(lc)
	plt.subplots_adjust(hspace=0.5)
	ax1.tick_params(labelsize=8)
	ax2.tick_params(labelsize=8)
	ax3.tick_params(labelsize=8)
	ax4.tick_params(labelsize=8)
	os.chdir('../')
	os.chdir(path)
	plt.savefig('creation_network.pdf')

complexity_network=100
min_distance = 0.01*length_domain[0]
network = Network(dimension, complexity_network, length_domain, min_distance, beam_Young, beam_poisson, beam_profile, truss_young, truss_poisson, truss_area,disturbance, hyperstatic_param, creation, generation, path)

set_fibers_explanation(network,path)


#############################################################


def length_square(x):
	if len(x) ==2: return x[0]**2+x[1]**2
	if len(x) ==3: return x[0]**2+x[1]**2+x[2]**2

fig3 = plt.figure(constrained_layout=True)
gs = fig3.add_gridspec(4,2)
f3_ax1 = fig3.add_subplot(gs[:2,0])
f3_ax2 = fig3.add_subplot(gs[:2,1])
f3_ax3 = fig3.add_subplot(gs[2,0])
f3_ax4 = fig3.add_subplot(gs[2,1])
f3_ax5 = fig3.add_subplot(gs[3,0])
f3_ax6 = fig3.add_subplot(gs[3,1])
import seaborn as sns

### Voronoi
creation="Voronoi"
generation = 'random'
complexity_network=500 #number of random seed points
length_domain=(1.0,1.0,1.0)
min_distance = 0.0001*length_domain[0]
network = Network(dimension, complexity_network, length_domain, min_distance, beam_Young, beam_poisson, beam_profile, truss_young, truss_poisson, truss_area,disturbance, hyperstatic_param, creation, generation, path)
network=network.set_fibers_1(path)
f3_ax1.scatter(network.vertices[:,0],network.vertices[:,1], s =2.)
line_segments=[]
for simplex in network.ridge_vertices:
		simplex = numpy.asarray(simplex)
		line_segments.append([(x, y) for x, y in network.vertices[simplex]])
lc = LineCollection(line_segments,linestyle='solid')
f3_ax1.add_collection(lc)
f3_ax1.set_title('Voronoi geometry')

length_ini = []
cos_theta=[]
for ridge in network.ridge_vertices:
	length_ini.append(np.sqrt(length_square(network.vertices[ridge[1]]-network.vertices[ridge[0]])))
	cos_theta.append(np.dot(network.vertices[ridge[1]]-network.vertices[ridge[0]], [1.,0.])/length_ini[-1])

sns.histplot(data=length_ini,kde=True,ax=f3_ax3)
sns.histplot(data=cos_theta,kde=True,ax=f3_ax5)
f3_ax3.set_title('Voronoi distribution of length')
f3_ax5.set_title(r'Voronoi distribution of $cos\theta$')



### Growth network
creation="growth_network"
generation = 'grid'
complexity_network=500 #number of random seed points
length_domain=(1.0,1.0,1.0)
min_distance = 0.0001*length_domain[0]
network = Network(dimension, complexity_network, length_domain, min_distance, beam_Young, beam_poisson, beam_profile, truss_young, truss_poisson, truss_area,disturbance, hyperstatic_param, creation, generation, path)
network=network.set_fibers_1(path)
f3_ax2.scatter(network.vertices[:,0],network.vertices[:,1], s =2.)
line_segments=[]
for simplex in network.ridge_vertices:
		simplex = numpy.asarray(simplex)
		line_segments.append([(x, y) for x, y in network.vertices[simplex]])
lc = LineCollection(line_segments,linestyle='solid')
f3_ax2.add_collection(lc)
f3_ax2.set_title('Growth geometry')

length_ini = []
cos_theta=[]
for ridge in network.ridge_vertices:
	length_ini.append(np.sqrt(length_square(network.vertices[ridge[1]]-network.vertices[ridge[0]])))
	cos_theta.append(np.dot(network.vertices[ridge[1]]-network.vertices[ridge[0]], [1.,0.])/length_ini[-1])
		

sns.histplot(data=length_ini,kde=True,ax=f3_ax4)
sns.histplot(data=cos_theta,kde=True,ax=f3_ax6)
f3_ax4.set_title('Growth distribution of length')
f3_ax6.set_title(r'Growth distribution of $cos\theta$')

f3_ax1.tick_params(labelsize=8)
f3_ax2.tick_params(labelsize=8)
f3_ax3.tick_params(labelsize=8)
f3_ax4.tick_params(labelsize=8)
f3_ax5.tick_params(labelsize=8)
f3_ax6.tick_params(labelsize=8)

plt.subplots_adjust(hspace=1.0,wspace=0.5)
plt.savefig('comp_initial.pdf')
"""
plt.show()

